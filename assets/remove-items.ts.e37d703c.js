import{g,c as y,a as B}from"./chrome-searches-storage.d5680d3f.js";chrome.runtime.onMessage.addListener(function(t,e,s){!t.message||t.message=="rerun_script_permission"&&(u.takeRecords(),u.disconnect(),h(),u.observe(_,f))});let d,l;const w=async()=>{let t=[""];const e=await chrome.storage.sync.get(["blocked"]);return!!e&&e.blocked&&e.blocked.length>0?t=e.blocked:await chrome.storage.sync.set({blocked:[""]}),t};var v;const _=(v=document.getElementById("content"))!=null?v:document.body,f={subtree:!0,childList:!0},u=new MutationObserver(function(t,e){e.takeRecords(),e.disconnect(),h(),e.observe(_,f)});function x(){u.observe(_,f),!!location.href&&!location.href.includes("vinted.")&&u.disconnect()}L();async function h(){const t=await w(),e=n("feed-grid__item"),s=n("horizontal-scroll__item"),o=n("closet__item");r(e),r(o),r(s);function n(a,i){return i?Array.from(i.getElementsByClassName(a)):Array.from(document.getElementsByClassName(a))}function r(a){const i=[];a==null||a.forEach(c=>{b(c)&&i.push(c)}),i.forEach(c=>{c.style.display="none"})}function b(a){const i=n("new-item-box__description",a);if(!i)return;let c;const p=i[i.length-1];return p?c=p.querySelector("h4"):c=a.querySelectorAll('[data-testid$="description-subtitle"]')[0],c?m(c.innerHTML):void 0}function m(a){return(t==null?void 0:t.length)>0?t.includes(a.trim()):!1}}async function k(){var n;if(!await g())return;d=(n=_.querySelector('button[data-testid*="catalog-search-save-button"]'))!=null?n:_.querySelector('button[data-testid*="catalog-search-delete-button"]');const e=d.cloneNode(),s=e,o=document.createElement("div");o.setAttribute("id","save-to-vilter-container"),o.style.display="flex",o.style.flexDirection="column",o.style.gap="10px",s.setAttribute("id","save-to-vilter"),d.parentElement.style.alignItems="flex-start",s.innerHTML='<div class="web_ui__Chip__prefix" data-testid="catalog-search-save-button--prefix"><span class="web_ui__Icon__icon web_ui__Icon__regular web_ui__Icon__greyscale-level-1" data-icon-name="bookmark"><svg viewBox="0 0 24 24"><path d="M18.5 1h-13C4.67 1 4 1.67 4 2.5V23l8-5 8 5V2.5c0-.83-.67-1.5-1.5-1.5m0 1.5v17.8l-5.7-3.57-.8-.5-.8.5-5.7 3.56V2.5h13"></path></svg></span></div><div class="web_ui__Chip__text"><span class="web_ui__Text__text web_ui__Text__subtitle web_ui__Text__left web_ui__Text__amplified web_ui__Text__truncated" data-testid="catalog-search-save-button--text"><span>Sla op in Vilter</span></span></div>',o.appendChild(s),d.insertAdjacentElement("afterend",o),d.parentNode.style.gap="10px",e.addEventListener("click",E)}async function E(){if(await y(location.href)){alert("Deze zoekopdracht is al opgeslagen.");return}const e=document.getElementById("save-to-vilter");l=document.createElement("form");const s=l;s.style.width="100%",s.style.flex="1",s.style.display="flex",s.style.flexDirection="column",s.style.gap="10px";const o=document.createElement("label");o.style.fontSize="1.5rem",o.htmlFor="input-for-saved-search",o.innerHTML="<b>Geef je zoekopdracht een naam:</b>",l.appendChild(o);const n=document.createElement("input");n.style.fontSize="1.5rem",n.classList.add("web_ui__Card__card"),n.style.minHeight="20px",n.style.padding="8px 12px",n.id="input-for-saved-search",n.placeholder="Bv. kleurrijke vintage blouses",l.appendChild(n);const r=document.createElement("button");r.type="submit",r.innerHTML='<span class="web_ui__Button__label"><span class="web_ui__Button__label" style="color: white;">Voeg toe</span></span>',["web_ui__Button__button","web_ui__Button__filled","web_ui__Button__default","web_ui__Button__primary","web_ui__Button__truncated"].forEach(m=>{r.classList.add(m)}),l.appendChild(r),e.insertAdjacentElement("afterend",l),l.addEventListener("submit",S)}function S(){const t=document.getElementById("save-to-vilter"),e=document.getElementById("input-for-saved-search"),s=e.value;e.value="",B({description:s,query:location.href}),t.parentNode.removeChild(l)}function L(){x(),h(),k()}
